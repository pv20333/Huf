{"ast":null,"code":"import axios from 'axios';\nconst axiosInstance = axios.create({\n  baseURL: 'http://localhost:8080' // Adicione a URL completa do backend aqui\n});\n\nconst parseJwt = token => {\n  try {\n    return JSON.parse(atob(token.split(\".\")[1]));\n  } catch (e) {\n    return null;\n  }\n};\nexport const isExpired = () => {\n  const token = localStorage.getItem('token');\n  if (token) {\n    const decodedJwt = parseJwt(token);\n    if (decodedJwt.exp * 1000 < Date.now()) {\n      history.push('/login');\n    }\n  }\n};\nexport const isExpiredBoolean = () => {\n  const token = localStorage.getItem('token');\n  if (token) {\n    try {\n      const decodedJwt = parseJwt(token);\n      if (decodedJwt.exp * 1000 < Date.now()) {\n        return true;\n      }\n      return false;\n    } catch (e) {\n      return false;\n    }\n  }\n  return false;\n};\nexport const isNotExpiredBoolean = () => {\n  const token = localStorage.getItem('token');\n  if (token) {\n    try {\n      const decodedJwt = parseJwt(token);\n      if (decodedJwt.exp * 1000 >= Date.now()) {\n        return true;\n      }\n      return false;\n    } catch (e) {\n      return false;\n    }\n  }\n  return false;\n};\nexport const isNotExpired = () => {\n  const token = localStorage.getItem('token');\n  console.log(token);\n  if (token) {\n    try {\n      const decodedJwt = parseJwt(token);\n      if (decodedJwt.exp * 1000 >= Date.now()) {\n        console.log(\"Not expired\");\n        //history.push('/dashboard');\n      }\n    } catch (e) {}\n  }\n};\nexport const validateToken = async () => {\n  var _response$data, _response$data2;\n  const response = await axiosInstance.post('/verify-token', {\n    token: localStorage.getItem('token')\n  });\n  const valid = response === null || response === void 0 ? void 0 : (_response$data = response.data) === null || _response$data === void 0 ? void 0 : _response$data.valid;\n  console.log(\"Validatoken: \" + valid);\n  if (!valid) {\n    localStorage.removeItem('token');\n  }\n  return response === null || response === void 0 ? void 0 : (_response$data2 = response.data) === null || _response$data2 === void 0 ? void 0 : _response$data2.valid;\n  axiosInstance.post('/verify-token', {\n    token: localStorage.getItem('token')\n  }).then(response => {\n    if (response.data.valid) {\n      history.push('/');\n    } else {\n      setError('Invalid token');\n      localStorage.removeItem('token'); // Remover o token inv치lido do localStorage\n    }\n  }).catch(error => {\n    setError('Error occurred while verifying token');\n    localStorage.removeItem('token'); // Remover o token inv치lido do localStorage\n  });\n};","map":{"version":3,"names":["axios","axiosInstance","create","baseURL","parseJwt","token","JSON","parse","atob","split","e","isExpired","localStorage","getItem","decodedJwt","exp","Date","now","history","push","isExpiredBoolean","isNotExpiredBoolean","isNotExpired","console","log","validateToken","_response$data","_response$data2","response","post","valid","data","removeItem","then","setError","catch","error"],"sources":["C:/Users/tiago/OneDrive/Documentos/GitHub/Huf/Frontend/src/view/pages/login/token.jsx"],"sourcesContent":["import axios from 'axios';\r\n\r\nconst axiosInstance = axios.create({\r\n  baseURL: 'http://localhost:8080', // Adicione a URL completa do backend aqui\r\n});\r\n\r\n\r\nconst parseJwt = (token) => {\r\n    try {\r\n      return JSON.parse(atob(token.split(\".\")[1]));\r\n    } catch (e) {\r\n      return null;\r\n    }\r\n};\r\n\r\nexport const isExpired = () => {\r\n        const token = localStorage.getItem('token');\r\n        if(token){\r\n            const decodedJwt = parseJwt(token);\r\n            if (decodedJwt.exp * 1000 < Date.now()) {\r\n                history.push('/login');\r\n            }\r\n       }\r\n    \r\n\r\n}\r\n\r\nexport const isExpiredBoolean = () => {\r\n    const token = localStorage.getItem('token');\r\n    if(token){\r\n        try{\r\n            const decodedJwt = parseJwt(token);\r\n            if (decodedJwt.exp * 1000 < Date.now()) {\r\n                return true;\r\n            }\r\n            return false;\r\n        }catch(e){\r\n            return false;\r\n        }\r\n   }\r\n   return false;\r\n}\r\n\r\nexport const isNotExpiredBoolean = () => {\r\n    const token = localStorage.getItem('token');\r\n    if(token){\r\n        try{\r\n            const decodedJwt = parseJwt(token);\r\n            if (decodedJwt.exp * 1000 >= Date.now()) {\r\n                return true;\r\n            }\r\n            return false;\r\n        }catch(e){\r\n            return false;\r\n        }\r\n   }\r\n   return false;\r\n}\r\n\r\nexport const isNotExpired = () => {\r\n        const token = localStorage.getItem('token');\r\n        console.log(token)\r\n        if(token){\r\n             try{\r\n                const decodedJwt = parseJwt(token);\r\n                if (decodedJwt.exp * 1000 >= Date.now()) {\r\n                    console.log(\"Not expired\")\r\n                      //history.push('/dashboard');\r\n                 }\r\n             }catch(e){\r\n                \r\n             }\r\n    \r\n       }\r\n    \r\n\r\n}\r\n\r\nexport const validateToken = async () => {\r\n\r\n    const response = await axiosInstance.post('/verify-token', {token: localStorage.getItem('token')});\r\n    const valid = response?.data?.valid;\r\n    console.log(\"Validatoken: \" + valid)\r\n    if(!valid){\r\n        localStorage.removeItem('token');\r\n    }\r\n    return response?.data?.valid;\r\n\r\n    axiosInstance.post('/verify-token', { token: localStorage.getItem('token') })\r\n    .then((response) => {\r\n      if (response.data.valid) {\r\n        history.push('/');\r\n      } else {\r\n        setError('Invalid token');\r\n        localStorage.removeItem('token'); // Remover o token inv치lido do localStorage\r\n      }\r\n    })\r\n    .catch((error) => {\r\n      setError('Error occurred while verifying token');\r\n      localStorage.removeItem('token'); // Remover o token inv치lido do localStorage\r\n    });\r\n\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}